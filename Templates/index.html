<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Viewer</title>
    <style>
        table, th, td {
            border: 1px solid black;
            border-collapse: collapse;
        }
        th, td {
            padding: 8px 12px;
        }
    </style>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>

<h2>Data from Backend</h2>
<table id="data-table">
    <thead>
        <!-- Table headers will be added here -->
    </thead>
    <tbody>
        <!-- Table data will be added here -->
    </tbody>
</table>

<div id="plotlyDiv" style="width:90%"></div>

<script>
    // Fetch data from the Flask backend
    fetch('/predict')
    .then(response => response.json())
    .then(data => {
        const table = document.getElementById('data-table');
        const thead = table.querySelector('thead');
        const tbody = table.querySelector('tbody');

        // If data is available and not empty
        // Handle the table data similar to before
        const tableData = data.data;
        if(tableData.length > 0) {
            // Add table headers
            const headers = Object.keys(tableData[0]);
            let headerRow = '<tr>';
            for(let header of headers) {
                headerRow += `<th>${header}</th>`;
            }
            headerRow += '</tr>';
            thead.innerHTML = headerRow;

            // Add table rows
            for(let row of tableData) {
                let rowHTML = '<tr>';
                for(let header of headers) {
                    rowHTML += `<td>${row[header]}</td>`;
                }
                rowHTML += '</tr>';
                tbody.innerHTML += rowHTML;
            }
        } else {
            table.innerHTML = '<tr><td>No data available</td></tr>';
        }
        
        const graphData = JSON.parse(data.graph);
        Plotly.newPlot('plotlyDiv', graphData.data, graphData.layout);
    })
    .catch(error => {
        console.error('There was an error fetching the data', error);
    });
</script>

</body>
</html>
